\subsection{Finding the UAP}

The UAP (Upper Address Part) is the important to do anything interesting with Bluetooth. For instance it used to determine the hopping sequence that is used for the communication between two devices. It is 8 bits of the 48 buts BD_ADDR(Bluetooth Device address). The LAP is transmitted in plaintext so it not hard to find. You just have to find one of the packets. The First part is the NAP(Non-significant Adresss Part). This part is ignored because it is not needed for the initial communication. Because the UAP is only 8 bits it can be brute forced. This is not a good way to find it. Brute forcing is detectable and it will only work when the master is a connectible state. 
The ubertooth is made to be a passive sniffer so this method is not used. One of the techniques used to determine the UAP is by using the HEC(Header Error Check). This is used to check if the header is received without errors. With this you can determine which what the bits are that are unknown which will be your UAP. This header is send with each packet so it makes it easy to decode. The only problem is that is XOR with a pseudo-random stream. To try and decode this is called "whitening". There are 64 possible streams it will use and this depends on which clock is used. It will then generate 64 candidate UAP with each of the 64 streams. Sometimes the packets will have a CRC so you can then use this to check if you used the right stream to decode your packet.
Another method is to perform a series of sanity checks on the packet format. You can then unwhiten the packet type. If you know the packet type you can derive some information like the packet length. With this you can confirm or deny a possible match. The problem with this is that you sometimes you will false negatives and eliminate UAP streams which are valid. This can happen, because the thing that you decode will give you the wrong packet type and you will make the wrong conclusion on whether to or throw away this possible clock. This will lead to not finding any UAP for the master. You will have to restart the process and hope it will work this time.

\subsection{Finding the right clock}

\subsection{Tools}